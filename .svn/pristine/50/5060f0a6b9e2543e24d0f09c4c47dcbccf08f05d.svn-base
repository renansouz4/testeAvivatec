package Actions;

import org.openqa.selenium.WebDriver;

import com.relevantcodes.extentreports.LogStatus;

import ActionFindElementSelenium.AcoesFindElement;
import ConstantsSuiteTests.ConstanteUrlBroweser;
import PageObjects.AssociarOfertaDependentePageObject;
import PageObjects.AssociarPromocaoPageObject;
import PageObjects.CriarPromocaoPageObject;
import Report.ExtentReport;
import Report.Report;

/**
 * - Class Action
 * 
 * @author rodrigo.c.almeida
 * 
 */
public class OfertaDependenteAction extends AcoesFindElement {

	private WebDriver driver;
	String URL = ConstanteUrlBroweser.URL_CLARO;
	private ExtentReport reportHTML;
	private Report report;

	/**
	 * - Construtor da Class.
	 */
	public OfertaDependenteAction(WebDriver driver, ExtentReport reportHTML, Report report) {
		this.driver = driver;
		this.reportHTML = reportHTML;
		this.report = report;
	}

	/**
	 * - Método responsável por associar a oferta dependente.
	 */
	public void associarOfertaDependente(String nomeOferta, String listaTipoProduto,
			String nomePlano) {
		click(driver, AssociarOfertaDependentePageObject.linkPlano);
		click(driver, AssociarOfertaDependentePageObject.linkAssociarOfertaDep);
		
		reportHTML.test.log(LogStatus.INFO, "Iniciando a execucao da action de associacao de oferta dependente de nome: "+nomeOferta);
		reportHTML.test.log(LogStatus.INFO, reportHTML.test.addScreenCapture(report.capturar()));
		
		fillInput(driver, AssociarOfertaDependentePageObject.inputNomeOferta, nomeOferta);
		click(driver, AssociarOfertaDependentePageObject.clickButtonPesquisarOferta);
		selectElementVisibleText(driver, AssociarOfertaDependentePageObject.selectOferta, nomeOferta);
		selectElementVisibleText(driver, AssociarOfertaDependentePageObject.selectTipoProduto, listaTipoProduto);
		fillInput(driver, AssociarOfertaDependentePageObject.inputNomePlano, nomePlano);
		
		reportHTML.test.log(LogStatus.INFO, "Inserindo o tipo de produto de nome: "+listaTipoProduto+" e plano de nome: "+nomePlano);
		reportHTML.test.log(LogStatus.INFO, reportHTML.test.addScreenCapture(report.capturar()));
		
		click(driver, AssociarOfertaDependentePageObject.clickButtonPesquisarPlano);
		selectElementByIndexMethod(driver, AssociarOfertaDependentePageObject.selectPlanosNaoAssociados,1);
		click(driver, AssociarOfertaDependentePageObject.clickButtonAssociarPlano);
		reportHTML.test.log(LogStatus.INFO, "Plano associado com sucesso.");
		reportHTML.test.log(LogStatus.INFO, reportHTML.test.addScreenCapture(report.capturar()));
	}
}
